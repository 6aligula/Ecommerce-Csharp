@model E_Commerce_App.WebUI.ViewModels.ProductListViewModel
@{
    Layout = "_Layout";
}
@section Css{
    <!-- Product Css -->
    <link rel="stylesheet" href="~/css/product.css" />
}
<br />
@await Component.InvokeAsync("Categories")
<br />
<div class="row" id="productsArea">

</div>
<!--  TODO eğer sepete ekle yapınca kullanıcı login olmamışsa login sayfasına yönlendir
    parametre olark returnurl kullan controller kısmında kontrol edilir-->
<div class="wrapper">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div>
                    <ul id="pagination-demo" class="pagination-sm"></ul>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script src="~/node_modules/twbs-pagination/jquery.twbsPagination.min.js"></script>
    <script>
        $('#pagination-demo').twbsPagination({
            totalPages: @Model.PageInfo.GetTotalPage(),
            visiblePages: 6,
            next: 'Sonraki',
            prev: 'Önceki',
            onPageClick: function (event, page) {
                //fetch content and render here
                console.log(page);
                $.ajax({
                    type: 'GET',
                    url: '/GetProducts/' + page,
                    data: '{page:' + page + '}',
                    contentType: false,
                    processData: false,
                    success: function (res) {
                        $("#productsArea").html("");
                        var products = res.data.products;
                        console.log(res.data);
                        for (var i = 0; i < products.length; i++) {
                            console.log(products.length);
                            $("#productsArea").append(product(products, i));
                        }
                    }
                });
            }
        });


        function product(data, index){
            let html =
                `
                <div class="col-md-3">
                    <div class="dress-card">
                        <div class="dress-card-head">
                            <img class="dress-card-img-top" src="https://assets.myntassets.com/h_1440,q_100,w_1080/v1/assets/images/7578935/2018/10/23/d7b740bc-e00e-4bec-97aa-65016f8ff2e71540289479612-Harpa-Women-Dresses-2331540289479465-1.jpg" alt="">
                            <div class="surprise-bubble">
                                <span class="dress-card-heart">
                                    <i class="fas fa-shopping-cart"></i>
                                </span><a href="#"><span>Ekle</span></a>
                            </div>
                        </div>
                        <div class="dress-card-body">
                            <h4 class="dress-card-title" style="text-align:center;">${data[index].name}</h4>
                            <div class="row">
                                <div class="col-md-12 card-button">
                                    <a href="/${data[index].url}">
                                        <div class="card-button-inner wish-button">
                                            <p class="dress-card-para"><span class="dress-card-price">${data[index].price} ₺</span><b>İncele</b></p>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                `;
            return html;
        }


    </script>
}
<style>
    .wrapper {
        margin: 60px auto;
        text-align: center;
    }

    h1 {
        margin-bottom: 1.25em;
    }

    #pagination-demo {
        display: inline-block;
        margin-bottom: 1.75em;
    }

        #pagination-demo li {
            display: inline-block;
        }

    .page-content {
        background: #eee;
        display: inline-block;
        padding: 10px;
        width: 100%;
        max-width: 660px;
    }
</style>
